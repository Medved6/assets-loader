!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.assetsLoader=e()}}(function(){return function e(t,n,r){function s(o,a){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!a&&u)return u(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(s(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),u=1;r>u;u++)i[u-1]=arguments[u];n.apply(this,i)}else if(o(n)){for(r=arguments.length,i=new Array(r-1),u=1;r>u;u++)i[u-1]=arguments[u];for(c=n.slice(),r=c.length,u=0;r>u;u++)c[u].apply(this,i)}return!0},r.prototype.addListener=function(e,t){var n;if(!s(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,"function"==typeof console.trace)}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!s(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,a;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||s(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=i;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],s(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?s(e._events[t])?1:e._events[t].length:0}},{}],2:[function(e,t,n){"use strict";t.exports=function(){try{return!!new Blob}catch(e){return!1}}()},{}],3:[function(e,t,n){"use strict";function r(){s.call(this),this.setMaxListeners(20)}var s=e(1).EventEmitter;r.prototype=Object.create(s.prototype),r.prototype.constructor=r,r.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()},t.exports=r},{1:1}],4:[function(e,t,n){"use strict";var r=e(3),s=e(6),i=0;t.exports=function o(e){var t,n={},a=[],u=[],c=0,l=0,f={},v=function(n){if(Array.isArray(n))return n.forEach(v),t;var r,i=!!n.assets&&Array.isArray(n.assets);return r=i?o(m(n,e)):s(m(n,e)),u.push(r),f[r.id]=r,t},h=function(e){return arguments.length?n[e]:a},d=function(e){if(h(e))return h(e);var t=null;return Object.keys(f).some(function(n){return t=f[n].find&&f[n].find(e),!!t}),t},p=function(e){return e&&e.split("?")[0].split(".").pop().toLowerCase()},m=function(e,t){if("string"==typeof e){var n=e;e={url:n}}return void 0===e.isTouchLocked&&(e.isTouchLocked=t.isTouchLocked),void 0===e.blob&&(e.blob=t.blob),void 0===e.basePath&&(e.basePath=t.basePath),e.id=e.id||e.url||String(++i),e.type=e.type||p(e.url),e.crossOrigin=e.crossOrigin||t.crossOrigin,e.webAudioContext=e.webAudioContext||t.webAudioContext,e.log=t.log,e},g=function(){return l=u.length,u.forEach(function(e){e.on("progress",b).once("complete",y).once("error",L).start()}),u=[],t},b=function(e){var n=c+e;t.emit("progress",n/l)},y=function(e,r,s){Array.isArray(e)&&(e={id:r,file:e,type:s}),c++,t.emit("progress",c/l),n[e.id]=e.file,a.push(e),t.emit("childcomplete",e),_()},L=function(e){l--,t.listeners("error").length&&t.emit("error",e),_()},_=function(){c>=l&&t.emit("complete",a,e.id,"group")},w=function(){for(;u.length;)u.pop().destroy();return t.off("error"),t.off("progress"),t.off("complete"),a=[],n={},e.webAudioContext=null,l=0,c=0,t};return t=Object.create(r.prototype,{_events:{value:{}},id:{get:function(){return e.id}},add:{value:v},start:{value:g},get:{value:h},find:{value:d},getLoader:{value:function(e){return f[e]}},loaded:{get:function(){return c>=l}},file:{get:function(){return a}},destroy:{value:w}}),e=m(e||{},{basePath:"",blob:!1,touchLocked:!1,crossOrigin:null,webAudioContext:null,log:!1}),Array.isArray(e.assets)&&v(e.assets),Object.freeze(t)}},{3:3,6:6}],5:[function(e,t,n){"use strict";var r=e(4);r.stats=e(7),t.exports=r},{4:4,7:7}],6:[function(e,t,n){"use strict";var r=e(3),s=e(2),i=e(7);t.exports=function(e){var t,n,o,a,u,c,l=e.id,f=e.basePath||"",v=e.url,h=e.type,d=e.crossOrigin,p=e.isTouchLocked,m=e.blob&&s,g=e.webAudioContext,b=e.log,y=function(){switch(a=Date.now(),h){case"json":A();break;case"jpg":case"png":case"gif":case"webp":O();break;case"mp3":case"ogg":case"opus":case"wav":case"m4a":j();break;case"ogv":case"mp4":case"webm":case"hls":U();break;case"bin":case"binary":_("arraybuffer");break;case"txt":case"text":_("text");break;default:throw"AssetsLoader ERROR: Unknown type for file with URL: "+f+v+" ("+h+")"}},L=function(e){e&&(c={id:l,file:e,type:h},t.emit("progress",1),t.emit("complete",c,l,h),N())},_=function(e,t){n=t||x,o=new XMLHttpRequest,o.open("GET",f+v,!0),o.responseType=e,o.addEventListener("progress",w),o.addEventListener("load",n),o.addEventListener("error",F),o.send()},w=function(e){e.lengthComputable&&t.emit("progress",e.loaded/e.total)},x=function(){E()&&L(o.response)},E=function(){return o&&o.status<400?(i.update(o,a,v,b),!0):(F(o&&o.statusText),!1)},A=function(){_("json",function(){if(E()){var e=o.response;"string"==typeof e&&(e=JSON.parse(e)),L(e)}})},O=function(){m?C():T()},T=function(){o=new Image,d&&(o.crossOrigin="anonymous"),o.addEventListener("error",F,!1),o.addEventListener("load",k,!1),o.src=f+v},k=function(){window.clearTimeout(u),L(o)},C=function(){_("blob",function(){E()&&(o=new Image,o.addEventListener("error",F,!1),o.addEventListener("load",R,!1),o.src=window.URL.createObjectURL(o.response))})},R=function(){window.URL.revokeObjectURL(o.src),L(o)},j=function(){g?D():M("audio")},U=function(){m?_("blob"):M("video")},D=function(){_("arraybuffer",function(){E()&&g.decodeAudioData(o.response,function(e){o=null,L(e)},function(e){F(e)})})},M=function(e){o=document.createElement(e),p||(window.clearTimeout(u),u=window.setTimeout(k,2e3),o.addEventListener("canplaythrough",k,!1)),o.addEventListener("error",F,!1),o.preload="auto",o.src=f+v,o.load(),p&&L(o)},F=function(e){window.clearTimeout(u);var n=e;if(o&&o.tagName&&o.error){var r=["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"];n="MediaError: "+r[o.error.code]+" "+o.src}else o&&o.statusText?n=o.statusText:e&&e.message?n=e.message:e&&e.type&&(n=e.type);t.emit("error",'Error loading "'+f+v+'" '+n),P()},N=function(){t.off("error"),t.off("progress"),t.off("complete"),o&&(o.removeEventListener("progress",w),o.removeEventListener("load",n),o.removeEventListener("error",F),o.removeEventListener("load",k),o.removeEventListener("canplaythrough",k),o.removeEventListener("load",R))},P=function(){N(),o&&o.abort&&o.readyState<4&&o.abort(),o=null,g=null,c=null,window.clearTimeout(u)};return t=Object.create(r.prototype,{_events:{value:{}},id:{value:e.id},start:{value:y},loaded:{get:function(){return!!c}},file:{get:function(){return c}},destroy:{value:P}}),Object.freeze(t)}},{2:2,3:3,7:7}],7:[function(e,t,n){"use strict";t.exports={mbs:0,secs:0,update:function(e,t,n,r){var s,i=e.getAllResponseHeaders();if(i){var o=i.match(/content-length: (\d+)/i);o&&o.length&&(s=o[1])}if(s){s=parseInt(s,10);var a=s/1024/1024,u=(Date.now()-t)/1e3;this.secs+=u,this.mbs+=a,r&&this.log(n,a,u)}else r&&console.warn.call(console,"Can't get Content-Length:",n)},log:function(e,t,n){if(e){var r="File loaded: "+e.substr(e.lastIndexOf("/")+1)+" size:"+t.toFixed(2)+"mb time:"+n.toFixed(2)+"s speed:"+(t/n).toFixed(2)+"mbps";console.log.call(console,r)}var s="Total loaded: "+this.mbs.toFixed(2)+"mb time:"+this.secs.toFixed(2)+"s speed:"+this.getMbps().toFixed(2)+"mbps";console.log.call(console,s)},getMbps:function(){return this.mbs/this.secs}}},{}]},{},[5])(5)});